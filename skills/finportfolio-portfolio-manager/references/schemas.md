# FinPortolio JSON Schemas

## portfolio.json

```json
{ "holdings": [ <holding>, ... ] }
```

### Holding object

| Field | Type | Required | Notes |
|---|---|---|---|
| `asset` | string | yes | Display name (e.g. "Bitcoin", "WEGE3") |
| `ticker` | string | yes | Ticker symbol. For Tesouro bonds, the full bond name (e.g. "Tesouro IPCA+ 2026") |
| `quantity` | number | yes | Current shares/coins/units held |
| `localCurrency` | string | yes | `"BRL"` or `"USD"` |
| `sector` | string | yes | e.g. Technology, Financials, Crypto, Fixed Income, Utilities |
| `country` | string | yes | e.g. US, Brazil, Netherlands, Taiwan; `"crypto"` for crypto assets |
| `type` | string | yes | `Stocks`, `Crypto`, `Fixed Income`, `FII`, `REITS`, `Gold` |
| `techExposed` | boolean | yes | `true` if sensitive to tech/crypto market cycle |
| `costBasis` | number | no | Total cost in BRL — **Tesouro bonds only** (not priced via yfinance) |

**Tech-exposed sectors:** Technology, Semiconductors, Semi Equip, BTC proxy, Crypto

---

## transactions.json

```json
{
  "source": "...",
  "as_of": "YYYY-MM-DD",
  "notes": "...",
  "portfolio": {
    "<category>": [ <asset_record>, ... ]
  }
}
```

### Asset record

```json
{
  "ticker": "AAPL",
  "currency": "USD",
  "current_quantity": 19,
  "transactions": [ <transaction>, ... ]
}
```

### Transaction object

| Field | Type | Required | Notes |
|---|---|---|---|
| `date` | string | yes | `YYYY-MM-DD` |
| `type` | string | yes | `"buy"` or `"sell"` |
| `quantity` | number | yes | Positive for buys, **negative for sells** |
| `gross_amount` | number | yes | Always positive |
| `net_amount` | number | no | Net after fees; `null` if unknown |
| `currency` | string | no | Only include when different from the asset record's `currency` |

---

## current_prices.json (generated — do not edit manually)

```json
{
  "timestamp": "ISO datetime",
  "usd_brl_rate": 5.1595,
  "holdings": [
    {
      "asset": "Bitcoin",
      "ticker": "BTC",
      "type": "Crypto",
      "local_currency": "USD",
      "price_local": 66088.21,
      "price_usd": 66088.21,
      "quantity": 0.376,
      "value_local": 24851.59,
      "value_usd": 24851.59
    }
  ]
}
```

Fully regenerated by `update_prices.py`. Never edit manually.

---

## Special Cases

**Tesouro bonds:**
- `ticker` in `portfolio.json` is the full name, e.g. `"Tesouro IPCA+ 2026"`
- Use `costBasis` (total BRL value) as fallback when the API is unavailable
- `type` = `"Fixed Income"`, `localCurrency` = `"BRL"`

**FIIs (Brazilian REITs):**
- Category `fiis_brazil` in `transactions.json`
- `type` = `"FII"` in `portfolio.json`
- Priced via yfinance with `.SA` suffix

**Crypto:**
- `quantity` is actual coin count (e.g. `0.376` BTC)
- Prices always fetched in USD even when `localCurrency` is BRL
- Supported tickers: BTC, ETH, AVAX (extend `crypto_map` in `update_prices.py` for others)
